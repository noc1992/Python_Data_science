?# Numpy Basic

Numpy는 고성능 과학계산을 위한 데이터 분석 패키지다. 주요 기능은 다음과 같다.

- 벡터 산술연산
- 다차원 배열
- 표준 수학 함수
- 선형대수, 난수 생성, 푸리에 변환 등

<br> 

## 목차 
 1. ndarray  
 1.1 배열 생성함수  
 1.2 배열의 데이터 타입  
 1.3 배열과 스칼라 연산  
 1.4 NumPy 배열 인덱싱과 슬라이싱  
 1.5 불리언 인덱싱  
 
2. 유니버셜 함수 ufunc
3. 배열을 사용한 데이터 처리
3.1 조건절 표현  
3.2 통계 메서드  
3.3 불리언 메서드  
3.4 정렬 메서드  
3.5 집함 함수  

4. 배열의 파일 입출력
5. 선형대수
6. 난수 생성

<br> 

# 1. ndarray 다차원 배열 객체 

ndarray는 같은 종류의 데이터를 담을 수 있는 포괄적인 다차원 배열이다. **ndarray의 모든 원소는 같은 자료형**이어야만 한다.

- Shape :  배열의 각 차원의 크기를 지정할 때 사용하는 튜플. 차원의 구조를 볼 떄 사용. (row, col)로 표시된다.
- dtype : 배열에 저장된 자료형을 알려주는 객체

<br>

## 1.1 배열 생성 함수
- np.array() 
	- 순서가 있는 객체  (주로 리스트)를 받아 데이터가 들어있는 새로운 Numpy 배열 생성
	- 다차원 배열 생성시 배열의 길이가 동일해야 한다.
	- 다차원 배열은 일종의 매스릭스와 비슷하다.
	- dtype로 자료형을 설정할 수 있다.

- np.zeros, np.ones
	- 각각 0과 1이 들어있는 배열을 생성한다.
	- 다차원 배열을 생성하려면 (row, col)로된 튜플을 입력한다.

- np.empty
	- ones, zeros와 비슷하나, 값을 초기화하지는 않는다.

- np.arange(n)
	- 배열 버전의 range 함수. 자료형 디폴트값은 float64
    
 <br> 
 
## 1.2 배열의 데이터 타입

`np.array(list, dtype=np.int8)`와 같은 식으로 데이터 타입을 명시할 수 있다.

`array.dtype`으로 해당 ndarray의 데이터 타입을 확인할 수 있다.

주로 사용하는 데이터 타입은 다음과 같다.

- 부동소수점 : float
- 복소수 : complex
- 점수 : int
- 문자열 : string
- 불리언 : bool
- 파이썬 객체 : object

<br>

## 1.3 배열과 스칼라 연산
NumPy의 큰 장점은 벡터 연산이 가능하다는 것이다. for문을 사용하지 않고도 우리가 원하는 배열 연산을 NumPy를 활용하면 직관적으로 수행할 수 있다.

배열은 익숙한 리스리 형태라고 생각하면 되고, 스칼라는 단일값을 의미한다.

[1, 2, 3] 이라는 벡터에 2 라는 스칼라를 곱하면 [2, 4, 6]이라는 결과를 얻을 수 있다.

한편, 크기가 다른 배열 간의 연산은 [브로드캐스팅(Broadcasting)](https://sacko.tistory.com/16)이라고 한다. 이 개념은 딥러닝의 기본적인 개념을 이해할 때 꼭 나오는 개념이므로 반드시 숙지하자. 

<br>

## 1.4 NumPy 배열 인덱싱과 슬라이싱

<br>

### 1.4.1 NumPy 배열과 python 리스트 비교

파이썬 리스트와 Numpy 배열의 큰 차이점은 Numpy 배열에서 브로드캐스팅 개념이 적용되어 for문을 사용하지 않고도 계산이 가능하고, 슬라이싱에서도 for문 없이 바로 슬라이싱에 값을 입력할 수 있다는 점이다.

또한 Numpy 배열은 슬라이싱이 가능해 원하는 인덱스 자리에 값을 할당할 수 있지만, 파이썬의 리스트는 불가능하며, for문을 이용해 각 인덱스별로 꺼내서 할당해야 한다.

그리고 Numpy배열에서 슬라이싱을 통해 값을 할당한 경우, 배열이 새롭게 생성되어 반환되는것이 아니라 **기존 배열의 값을 수정한다.**

이는 Numpy가 대용량 데이터 처리를 염두해 두고 성능을 끌어올리기 위함이라 볼 수 있다.

<br>

### 1.4.2 다차원 배열의 인덱싱
다차원 배열의 인덱싱은 차원을 콤마로 구분해서 넘기면 쉽게 가능하다.

- array[row, col] 또는 array[row][col]

다차원 배열의 또 다른 특징은 행과 열을 기준으로 슬라이싱이 가능하다는 점이다.

- array(row1:row2, col1:col2]
- array(:2, 1:) : 0 ~ 1행, 1열 ~ 모든 열

<br>

## 1.5 불리언 인덱싱

실제 데이터 분석에서 전처리를 하거나 통계 정보를 수집할 때 불리언 인덱싱을 많이 사용한다. 흥미로운 점은 앞에서 다룬 배열의 산술연산과 마찬가지로 비교연산(==, !=)도 동일하게 사용가능하다는 점이다.

한편 비교연산을 위해 논리연산을 사용하기 위해서는 파이썬 예약어 `and`, `or`은 사용할 수 없으므로 각각 `&`와 `|`를 사용해야 한다.

불리언 인덱싱을 응용하면 데이터 전처리가 수월해질 수 있다. 예를 들어 데이터 수집과정에서 0 이하의 값을 0으로 치환해야 할 경우 
`data[data < 0] = 0` 한 줄 이면 끝난다.

<br>

# 2. 유니버셜 함수

unfunc라고 불리는 유니버셜 함수는 ndarray안에 있는 데이터 원소 별로 연산을 수행하는 함수다. 일종의 래퍼 함수로 래퍼 함수(wrapper function)는 간다하게 다른 함수에 약간의 기능을 더해 사용하는 함수이다. 여기에서는 ndarray를 감싸 특정 연산을 고속으로 수행해주는 함수라고 생각하면 된다.

< NumPy Universal Function List >

<br>

1. 단일 배열에 사용하는 함수 리스트

| 함수  | 설명  |
|:----:|:----:|
|abs, fabs | 각 원소의 절대값을 구한다. 복소수가 아닌 경우에는 fabs로 빠르게 연산이 가능하다.  |
|sqrt|제곱근을 계산, arr ** 0.5와 동일|
|square|제곱을 계산 arr ** 2와 동일|
|exp|각 원소에 지수 ex를 계산|
|log, log10, log2, logp|각각 자연로그, 로그10, 로그2, 로그(1+x)|
|sign|각 원소의 부호를 계산|
|ceil|각 원소의 소수자리 올림|
|floor|각 원소의 소수자리 버림|
|rint|각 원소의 소수자리 반올림. dtype 유지|
|modf|원소의 몫과 나머지를 각각 배열로 반환|
|isnan|각 원소가 숫자인지 아닌지 NaN을 나타내는 불리언 배열|
|isfinite, isinf|배열의 각 원소가 유한한지 무한한지 나타내는 불리언 배열|
|cos, cosh, sin, sinh, tan, tanh|일반 삼각함수와 쌍곡삼각 함수|
|logical_not|각 원소의 논리 부정(not)값 계산, -arr와 동일|

<br>

2. 서로 다른 배열 간에 사용하는 함수 리스트

| 함수  | 설명  |
|:----:|:----:|
|add|첫번재 배열의 원소 + 두번째 배열의 원소|
|subtract|첫번째 배열의 원소 - 두번째 배열의 원소|
|multiply|첫번째 배열의 원소 * 두번째 배열의 원소|
|divide|첫번째 배열의 원소 / 두번째 배열의 원소|
|power|첫번째 배열의 원소 ** 두번째 배열의 원소|
|maximum, fmax|두 배열의 원소들 중 큰 값을 반환, fmax는 NaN 무시|
|minimum, fmin|두 배열의 원소들 중 작은값을 반환, fmin은 NaN무시|
|mod|첫번째 배열의 원소 % 두번째 배열의 원소|
|greater, greater_equal, less, less_equal, equal, not_equal|두 원소간의 `>`, `>=`, `<`, `<=`, `==`, `!=` 비교 연산 결과를 불리언 배열로 반환|
|logical_and, logical_or, logical_xor|각각 두 원소 간의 논리연산, `&`, `|`, `^` 결과를 반환|

<br>

# 3. 배열을 사용한 데이터 처리

<br>
	
## 3.1 조건절 표현

- np.where(조건, 참일때 반환할 값, 거짓일 떄 반환할 값) 
- `x if condition else y`를 벡터화 시킨 것.

<br> 

## 3.2 통계 메서드

Numpy를 이용해서 기본적인 계산을 할 수 있다. Numpy에 내장 함수를 이용해서 총합, 평균과 같은 기본적인 수학 계산을 할 수 있다.

< 기본 Numpy 통계 메서드 리스트 >

| 함수  | 설명  |
|:----:|:----:|
|sum|배열 전체 혹은 특정 행, 열에 대한 모든 원소의 합을 계산|
|mean|산술평균 계산|
|var, std|분산과 표준편차, 자유도를 줄 수 있다.|
|min, max|최소값, 최대값|
|argmin, argmax|최소원소의 인덱스 값(위치), 최대 원소의 인덱스 값(위치)|
|cumsum|각 원소의 누적 함|
|cumprod|각 원소의 누적 곱|

<br>

## 3.3 불리언 배열 메서드 

 - any : True값이 하나라도 있으면 True 반환
 - all : 모든 값이 True일 때 True 반환

<br>

## 3.4 정렬 메서드
내이썬 내장 리스트처럼 Numpy 배열도 sort 메서드로 정렬이 가능하다.

전달인자로 축(axis)의 값을 전달해서 행과 열별로 정렬이 가능하다.

- axis = 1 : 행 방향 (→)
- axis = 0 : 열 방향 (↓)

<br>

## 3.5 집함 함수

 - unique(x) : 배열 x에서 중복된 원소를 제거 한 후 정렬(sorted)하여 반환
 - intersect1d(x,y) : 배열 x와 y에 공통적으로 존재하는 원소를 정렬하여 반환
 - union1d(x,y) : 두 배열의 합짐합을 반환
 - in1d(x,y) : x의 원소 중 y의 원소를 포함하는지를 나타내는 불리언 배열을 반환
 - setdiff1d(x,y) : x와 y의 차집함을 반환
 - setxod1d(x,y) : 한 배열에는 포함하지만, 두 배열 모두에는 포함되지 않는 원소들의 집합인 대칭 차집합을 반환

<br>

# 4. 배열의 파일 입출력

np.save(파일명, ndarray)
np.load('파일명.npy')
np.savetxt, np.loadtxt

 <br>
 
# 5. 선형대수

np.dot(x, y)
np.diag
np.trace
np.linalg.det
np.linalg.eig
np.linalg.inv
np.linalg.svd
np.linalg.solve
np.linalg.lstsq

<br>

# 6. 난수 생성

numpy.random 모듈의 함수

- seed : 난수 발생기 시드 지정
- permutation : 순서를 임의로 바꾸거는 임의의 순열 반환
- shuffle : 배열의 순서 섞기
- rand : 균등분포에서 표본 추출
- randint : 주어진 최소/최대 범위 안에서 임의의 난수 추출
- randn : 표준편차가 1이고 평균값이 0인 정규분포에서 표본 추출
- binomial : 이항부포에서 표본 추
- normal : 정규분포에서 표본 추출
- beta : 베타분포에서 표본 추출
- chisquare : 카이제곱분포에서 표본 추출
- gamma : 감마분포에서 표본 추출
- uniform : 균등분포에서 표본 추출


